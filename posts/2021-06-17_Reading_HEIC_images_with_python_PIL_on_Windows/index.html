<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><meta name="og:site_name" content="Groundphlegm"/><link rel="canonical" href="https://groundphlegm.wedro.online/posts/2021-06-17_Reading_HEIC_images_with_python_PIL_on_Windows"/><meta name="twitter:url" content="https://groundphlegm.wedro.online/posts/2021-06-17_Reading_HEIC_images_with_python_PIL_on_Windows"/><meta name="og:url" content="https://groundphlegm.wedro.online/posts/2021-06-17_Reading_HEIC_images_with_python_PIL_on_Windows"/><title>Reading HEIC images with python PIL on Windows | Groundphlegm</title><meta name="twitter:title" content="Reading HEIC images with python PIL on Windows | Groundphlegm"/><meta name="og:title" content="Reading HEIC images with python PIL on Windows | Groundphlegm"/><meta name="description" content="It's not pretty, but it works!"/><meta name="twitter:description" content="It's not pretty, but it works!"/><meta name="og:description" content="It's not pretty, but it works!"/><meta name="twitter:card" content="summary"/><link rel="stylesheet" href="/styles.css" type="text/css"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><link rel="shortcut icon" href="/images/favicon.png" type="image/png"/><link rel="alternate" href="/rss.xml" type="application/rss+xml" title="Subscribe to Groundphlegm"/><link rel="preload" href="/svg.css" as="style"/><link rel="stylesheet" href="/styles_mobile.css" media="(max-width: 1200px)"/></head><body class="item-page"><header><div class="wrapper"><a class="site-name" href="/">Groundphlegm</a></div></header><div class="grid main-grid"><aside class="sidebar"><div class="list"><span>Currently Reading</span><div class="booklist-content"><div class="booklist-book"><img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1622818058l/21034583._SX98_.jpg" class="cover" alt="Cover for The Secret Service - Kingsman"/><div class="booktitle"><a href="https://www.goodreads.com/book/show/21034583-the-secret-service---kingsman">The Secret Service - Kingsman</a></div><div class="bookauthor">By Mark Millar</div></div><div class="booklist-book"><img src="https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1601964822l/55577838._SX98_.jpg" class="cover" alt="Cover for Glory To The Brave (Ascend Online, #3)"/><div class="booktitle"><a href="https://www.goodreads.com/book/show/55577838-glory-to-the-brave">Glory To The Brave (Ascend Online, #3)</a></div><div class="bookauthor">By Luke Chmilenko</div></div></div></div><div class="list contact-item"><span>Social</span><div><object class="social svg-image" role="img" title="Mastodon" type="image/svg+xml" data="/mastodon.svg"></object><a href="https://metalhead.club/@aymm" rel="me">@aymm@metalhead.club</a></div><div><object class="social svg-image" role="img" title="Pixelfed" type="image/svg+xml" data="/camera-retro-solid.svg"></object><a href="https://pixelfed.social/@aymm" rel="me">@aymm@pixelfed.social</a></div><div><object class="social svg-image" role="img" title="Github" type="image/svg+xml" data="/github.svg"></object><a href="https://github.com/hutattedonmyarm" rel="me">hutattedonmyarm</a></div><div><object class="social svg-image" role="img" title="Twitter" type="image/svg+xml" data="/twitter.svg"></object><a href="https://twitter.com/hutattedonmyarm" rel="me">@hutattedonmyarm</a></div><div><object class="social svg-image" role="img" title="Mail" type="image/svg+xml" data="/envelope.svg"></object><a href="mailto:max.nuding@icloud.com" rel="me">Max Nuding</a></div></div></aside><div class="wrapper main-wrapper"><article><div class="content"><h1>Reading HEIC images with python PIL on Windows</h1><p class="pubdate">Published: <time datetime="2021-06-17T14:25:00Z">Jun 17, 2021</time></p><p>Earlier today, I needed to open a HEIC image in PIL. A quick search found the packages <code>pyheif</code> and <code>pyheif-pillow-opener</code>. Well, turns out they don't work on Windows. And while I could just switch to a supported OS I really wanted to use Windows for this for a few reasons.</p><p>Some fiddling around later I had it working, here's how:</p><p><strong>Install libheif using vcpkg: <a href="https://github.com/Microsoft/vcpkg/">https://github.com/Microsoft/vcpkg/</a></strong></p><p>In order to read HEIC images we need <code>libheif</code>. The easiest way to get it is using <code>vcpkg</code>, a Microsoft tool to manage C and C++ libraries. Follow the installation guide on their github repo. In short:</p><ol><li>Clone the repo: <code>git clone https://github.com/Microsoft/vcpkg</code></li><li>Run the installation script: <code>.\vcpkg\bootstrap-vcpkg.bat</code></li><li>Install libheif (skip this if you're on a 32-Bit system and only run step 4): <code>.\vcpkg\vcpkg install libheif:x64-windows</code></li><li>I also installed the 32-Bit version, but I don't think it's necessary: <code>.\vcpkg\vcpkg install libheif</code></li><li>Not sure either if this is necessary, but I ran their integration from an elevated command prompt: <code>.\vcpkg\vcpkg integrate install</code></li></ol><p><strong>Install Imagemagick <a href="https://imagemagick.org/script/download.php#windows">https://imagemagick.org/script/download.php#windows</a></strong></p><p>I used the Windows binary, 16 bits-per-pixel, 64bit installer</p><p><strong>Install the python wand package</strong></p><p>Just run <code>pip install wand</code>. Make sure you're using a python 3 version and not python 2.7!</p><p>And that's it! Here's a snippet how to use it:</p><pre class="code">
<code>
from wand.image import Image
import PIL.Image
import io

with Image(filename=r'img.HEIC') as img:
    pil_image = PIL.Image.open(io.BytesIO(img.make_blob("jpg")))
</code>
</pre><p>It's pretty slow, because it needs to convert the image to jpg, but it works!</p></div><span>Tagged with: </span><ul class="tag-list"><li><a href="/tags/howto">howto</a></li><li><a href="/tags/programming">programming</a></li><li><a href="/tags/windows">windows</a></li><li><a href="/tags/python">python</a></li></ul></article></div></div><footer><p>Generated using <a href="https://github.com/johnsundell/publish">Publish</a></p><p><a href="/rss.xml">RSS feed</a></p><p>This blog is <a href="https://github.com/hutattedonmyarm/Groundphlegm-Src">open source</a></p></footer></body></html>